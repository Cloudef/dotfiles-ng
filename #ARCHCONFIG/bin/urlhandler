#!/bin/sh
# Common url handler
# termite uses this, dwb it's binded to ctrl+y

# $@ = Get domain from url
domain() {
   echo "$@" | sed -e "s/[^/]*\/\/\([^@]*@\)\?\([^:/]*\).*/\2/"
}

# $@ = URL
main() {
   case "$(domain "$@")" in
      *youtube.com)
         stream="$(youtube-dl -f 18 -g "$@")"
         mplayer -really-quiet -cache 10000 -cache-min 10 "$stream" &> /dev/null
      ;;
      *nicovideo.jp)
         nicoplay "$@" &> /dev/null
      ;;
      *)
         "$BROWSER" "$@" &> /dev/null &
      ;;
   esac
}
main "$@"
